<!DOCTYPE html>
<html>

<head>
    <!--<script src="https://aframe.io/releases/1.3.0/aframe.min.js"></script>-->
    <script src="JS/aframe-master.js"></script>
    <script
        src="https://unpkg.com/aframe-environment-component@1.3.0/dist/aframe-environment-component.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
    <script src="JS/highlight.js"></script>
    <script src="JS/changevideo.js"></script>
    <title>作品影像紀錄</title>
    <script type="text/javascript">
        function setCookie(cname, cvalue, exhour) {
            var d = new Date();
            d.setTime(d.getTime() + (exhour * 60 * 60 * 1000));
            var expires = "expires=" + d.toGMTString();
            document.cookie = cname + "=" + cvalue + "; " + expires;
        } function getCookie(cname) {
            var name = cname + "=";
            var ca = document.cookie.split(';');
            for (var i = 0; i < ca.length; i++) {
                var c = ca[i].trim();
                if (c.indexOf(name) == 0)
                    return c.substring(name.length, c.length);
            }
            return "";
        }
        window.onload = function checkCookie() {
            var cookiename = getCookie("inlunajin_theater");
            if (cookiename != "") {

            } else {
                cookiename = "come1hour";
                if (cookiename != "" && cookiename != null) {
                    const mobileDevice = ['Android', 'webOS', 'iPhone', 'iPad', 'iPod', 'BlackBerry', 'Windows Phone']
                    let isMobileDevice = mobileDevice.some(e => navigator.userAgent.match(e))
                    if (isMobileDevice) {
                        setTimeout(function () {
                            Swal.fire(
                                {
                                    icon: 'info',
                                    title: '歡迎來到電影院',
                                    html: '<b>本網頁包含大量影片<br>切換影片時讀取會花費較長時間<br>請耐心等待<br>或點擊下方按鈕進入Youtube撥放清單<br><br>如顯示錯誤請切換至良好網路環境並重新整理</b>',
                                    footer: '使用行動數據請注意流量', showDenyButton: true,
                                    denyButtonText: `Youtube`,
                                }
                            ).then((result) => {
                                if (result.isConfirmed) {

                                } else {
                                    window.location.href = "https://youtube.com/playlist?list=PLKebdc9CwOuUNL1PFo2vF3wRb9lA0toMV";
                                }
                            })
                        }, 1500);
                    }
                    else {

                        setTimeout(function () {
                            Swal.fire(
                                {
                                    icon: 'info',
                                    title: '歡迎來到電影院',
                                    html: '<b>本網頁包含大量影片<br>切換影片時讀取會花費較長時間<br>請耐心等待<br>或點擊下方按鈕進入Youtube撥放清單<br><br>如顯示錯誤請切換至良好網路環境並重新整理</b>',
                                    footer: '使用行動數據請注意流量',
                                    showDenyButton: true,
                                    denyButtonText: `Youtube`,
                                }
                            ).then((result) => {
                                if (result.isConfirmed) {

                                } else {
                                    window.location.href = "https://youtube.com/playlist?list=PLKebdc9CwOuUNL1PFo2vF3wRb9lA0toMV";
                                }
                            })
                        }, 500);

                    }
                    setCookie("inlunajin_theater", cookiename, 1);
                }
            }
        }

    </script>

    <link href="popoutstyle.css" rel="stylesheet" type="text/css">
</head>

<body>
    <a-scene background="color: #FFFFFF" cursor="rayOrigin: mouse; fuse: false" raycaster="objects: .raycastable"
        info-message="htmlSrc: #messageText" vr-mode-ui="enabled: false">
<a-gltf-model id="scenemodel" src="material/Theater.glb" position="0 0 0" material="shader: flat">
        </a-gltf-model>
        <a-gltf-model id="chair" src="material/TheaterChair.glb" position="0 0 0" material="shader: flat">
        </a-gltf-model>
        <a-gltf-model id="chair" src="material/TheaterChair.glb" position="0 -1.5 -6.25" material="shader: flat">
        </a-gltf-model>
        <a-gltf-model id="chair" src="material/TheaterChair.glb" position="0 -0.3 -1.25" material="shader: flat">
        </a-gltf-model>
        <a-gltf-model id="chair" src="material/TheaterChair.glb" position="0 -0.6 -2.5" material="shader: flat">
        </a-gltf-model>
        <a-gltf-model id="chair" src="material/TheaterChair.glb" position="0 -0.9 -3.75" material="shader: flat">
        </a-gltf-model>
        <a-gltf-model id="chair" src="material/TheaterChair.glb" position="0 -1.2 -5" material="shader: flat">
        </a-gltf-model>
        <a-gltf-model id="chair" src="material/TheaterChair.glb" position="0 -1.8 -7.5" material="shader: flat">
        </a-gltf-model>
        <a-gltf-model id="chair" src="material/TheaterChair.glb" position="0 -2.1 -8.75" material="shader: flat">
        </a-gltf-model>
        <a-entity light="type: point; color: #FFF; intensity: 1.5" position="0 50 0"></a-entity>

        <a-assets timeout = "10000">

            <img id="youtubeposter" src="material/youtube.png" crossorigin="anonymous" />
            <a-mixin id="youtubeframe" geometry="primitive: plane; width: 0.2; height: 0.2"
                material="transparent: true; shader: flat;opacity:0"></a-mixin>
            <a-mixin id="youtubeimage" geometry="primitive: plane; width: 0.2; height: 0.2"
                material="color: white; shader: flat;transparent: true" material="shader: flat" position="0 0 0.005">
            </a-mixin>
            
            <img id="loading" src="material/sceneloading.jpg" crossorigin="anonymous" />
            <a-mixin id="loadingimg" geometry="primitive: plane; width: 4; height: 1"
            material="color: white; shader: flat" material="shader: flat" position="0 0 0"></a-mixin>

            <img id="theaterinfo" src="material/theater/theaterinfo.png" crossorigin="anonymous" />
            <img id="fishbut" src="material/theater/but/fish_but.jpg" crossorigin="anonymous" />
            <img id="waterpoolbut" src="material/theater/but/waterpool_but.jpg" crossorigin="anonymous" />
            <img id="ARbut" src="material/theater/but/AR_but.jpg" crossorigin="anonymous" />
            <img id="VRbut" src="material/theater/but/VR_but.jpg" crossorigin="anonymous" />
            <img id="howbut" src="material/theater/but/how_but.jpg" crossorigin="anonymous" />
            <img id="deepoceanbut" src="material/theater/but/deepocean_but.jpg" crossorigin="anonymous" />
            <img id="live2Dbut" src="material/theater/but/live2D_but.jpg" crossorigin="anonymous" />
            <img id="liveofbirdbut" src="material/theater/but/liveofbird_but.jpg" crossorigin="anonymous" />
            <img id="logoutbut" src="material/theater/but/logout_but.jpg" crossorigin="anonymous" />
            <img id="particlebut" src="material/theater/but/particle_but.jpg" crossorigin="anonymous" />
            <img id="pythonbut" src="material/theater/but/python_but.jpg" crossorigin="anonymous" />

            <video id="waterpool" loop="false" src="material/theater/Movie/Waterpool.mp4"></video>
            <video id="fish" loop="false" src="material/theater/Movie/fish.mp4"></video>
            <video id="AR" loop="false" src="material/theater/Movie/AR.mp4"></video>
            <video id="VR" loop="false" src="material/theater/Movie/VR.mp4"></video>
            <video id="deepocean" loop="false" src="material/theater/Movie/DeepOcean.mp4"></video>
            <video id="python" loop="false" src="material/theater/Movie/python.mp4"></video>
            <video id="how" loop="false" src="material/theater/Movie/how.mp4"></video>
            <video id="live2D" loop="false" src="material/theater/Movie/live2D.mp4"></video>
            <video id="liveofbird" loop="false" src="material/theater/Movie/liveofbird.mp4"></video>
            <video id="logout" loop="false" src="material/theater/Movie/logout.mp4"></video>
            <video id="particle" loop="false" src="material/theater/Movie/particle.mp4"></video>
            
            <img id="Exitimg" src="material/exitarrow.png" crossorigin="anonymous" />
            <a-mixin id="Exitframe" geometry="primitive: plane; width: 1; height: 1"
                material="transparent: true; shader: flat;opacity:0"
                animation__scale="property: scale; to: 1.2 1.2 1.2; dur: 200; startEvents: mouseenter"
                animation__scale_reverse="property: scale; to: 1 1 1; dur: 200; startEvents: mouseleave"></a-mixin>
            <a-mixin id="Exitposter" geometry="primitive: plane; width: 1; height: 1"
                material="color: white; shader: flat;transparent: true" material="shader: flat" position="0 0 0.005">
            </a-mixin>
            <a-mixin id="frame" geometry="primitive: plane; width: 6; height: 1" material="color: white; shader: flat">
            </a-mixin>
            <a-mixin id="poster" geometry="primitive: plane; width: 5.9; height: 0.9"
                material="color: white; shader: flat" material="shader: flat" position="0 0 0.005"></a-mixin>
            <img id="Description" src="material/theater/des/movie_des.jpg" crossorigin="anonymous" />
            
            <img id="P_waterpool" src="material/theater/des/waterpool_des.jpg" crossorigin="anonymous" />
            <img id="P_liveofbird" src="material/theater/des/liveofbird_des.jpg" crossorigin="anonymous" />
            <img id="P_logout" src="material/theater/des/logout.jpg" crossorigin="anonymous" />
            <img id="P_deepocean" src="material/theater/des/deepocean_des.jpg" crossorigin="anonymous" />
            <img id="P_fish" src="material/theater/des/fish_des.jpg" crossorigin="anonymous" />
            <img id="P_VR" src="material/theater/des/VR_des.jpg" crossorigin="anonymous" />
            <img id="P_how" src="material/theater/des/how_des.jpg" crossorigin="anonymous" />
            <img id="P_AR" src="material/theater/des/AR_des.jpg" crossorigin="anonymous" />
            <img id="P_python" src="material/theater/des/python_des.jpg" crossorigin="anonymous" />
            <img id="P_particle" src="material/theater/des/particle_des.jpg" crossorigin="anonymous" />
            <img id="P_live2D" src="material/theater/des/live2D_des.jpg" crossorigin="anonymous" />
           
            <a-mixin id="manual" geometry="primitive: plane; width: 0.77; height: 1.4"
                material="color: white; shader: flat" material="shader: flat" position="0 0 0"></a-mixin>
        </a-assets>
        <a-entity id="background" position="0 0 0" geometry="primitive: sphere; radius: 2.0"
            material="color: red; side: back; shader: flat" scale="0.001 0.001 0.001" visible="false"
            class="raycastable">
        </a-entity>

        
        <a-entity position="0 1.6 0" camera
            look-controls="magicWindowTrackingEnabled: false; touchEnabled: true; mouseEnabled: true;reverse-mouse-drag:true">
            <a-entity material="src: #loading" mixin="loadingimg" position = "0 30 -50" scale = "7 7 7"></a-entity>
            <a-entity id="fadeBackground" geometry="primitive: sphere; radius: 2.5"
                material="color: black; side: back; shader: flat; transparent: true; opacity: 0.6" visible="false">
            </a-entity>

        </a-entity>
        <a-video id = "videoloc" src="#theaterinfo" width="16" height="9" position="0 1.6 -5" scale="0.43 0.43 0.43"></a-video>

        <a-entity id="ExitButton" position="5.5 0.5 -3" rotation="0 -90 0" mixin="Exitframe"
            class="raycastable menu-button">
            <a-entity material="src: #Exitimg" mixin="Exitposter"></a-entity>
        </a-entity>
        <a-entity id="ExitButton" position="-5.5 0.5 -3" rotation="0 90 0" mixin="Exitframe"
            class="raycastable menu-button">
            <a-entity material="src: #Exitimg" mixin="Exitposter"></a-entity>
        </a-entity>

        <!-- Hand controls -->
        <a-entity id="leftHand" laser-controls="hand: left" raycaster="objects: .raycastable"></a-entity>
        <a-entity id="rightHand" laser-controls="hand: right" raycaster="objects: .raycastable" line="color: #118A7E">
        </a-entity>
        <a-entity id="ui" position="0 1.55 -4.5">
            <!-- Poster menu -->

            <a-entity id="menu" rotation="0 0 0" highlight>


                <a-entity id="v_deepocean" position="4 1.6 0" mixin="frame" scale="0.3 0.3 0.3"
                    class="raycastable menu-button">
                    <a-entity material="src: #deepoceanbut" mixin="poster"></a-entity>
                </a-entity>
                <a-entity id="v_liveofbird" position="4 1.29 0" mixin="frame" scale="0.3 0.3 0.3"
                    class="raycastable menu-button">
                    <a-entity material="src: #liveofbirdbut" mixin="poster"></a-entity>
                </a-entity>
                <a-entity id="v_waterpool" position="4 0.98 0" mixin="frame" scale="0.3 0.3 0.3"
                    class="raycastable menu-button">
                    <a-entity material="src: #waterpoolbut" mixin="poster"></a-entity>
                </a-entity>
                <a-entity id="v_python" position="4 -1.19 0" mixin="frame" scale="0.3 0.3 0.3"
                    class="raycastable menu-button">
                    <a-entity material="src: #pythonbut" mixin="poster"></a-entity>
                </a-entity>
                <a-entity id="v_particle" position="4 0.67 0" mixin="frame" scale="0.3 0.3 0.3"
                    class="raycastable menu-button">
                    <a-entity material="src: #particlebut" mixin="poster"></a-entity>
                </a-entity>
                <a-entity id="v_fish" position="4 0.36 0" mixin="frame" scale="0.3 0.3 0.3"
                    class="raycastable menu-button">
                    <a-entity material="src: #fishbut" mixin="poster"></a-entity>
                </a-entity>
                <a-entity id="v_VR" position="4 0.05 0" mixin="frame" scale="0.3 0.3 0.3"
                    class="raycastable menu-button">
                    <a-entity material="src: #VRbut" mixin="poster"></a-entity>
                </a-entity>
                <a-entity id="v_AR" position="4 -0.26 0" mixin="frame" scale="0.3 0.3 0.3"
                    class="raycastable menu-button">
                    <a-entity material="src: #ARbut" mixin="poster"></a-entity>
                </a-entity>
                <a-entity id="v_how" position="4 -0.57 0" mixin="frame" scale="0.3 0.3 0.3"
                    class="raycastable menu-button">
                    <a-entity material="src: #howbut" mixin="poster"></a-entity>
                </a-entity>
                <a-entity id="v_live2D" position="4 -0.88 0" mixin="frame" scale="0.3 0.3 0.3"
                class="raycastable menu-button">
                <a-entity material="src: #live2Dbut" mixin="poster"></a-entity>
            </a-entity>
            <a-entity id="v_logout" position="4 -1.5 0" mixin="frame" scale="0.3 0.3 0.3"
                class="raycastable menu-button">
                <a-entity material="src: #logoutbut" mixin="poster"></a-entity>
            </a-entity>
                <a-entity id="tolink" position="0 0 0.5" change-video visible="false" scale="0.001 0.001 0.001">

                </a-entity>
                <a-entity id="tell" material="src: #Description" mixin="manual" position="-4 0.04 0" scale="2.5 2.5 2.5"
                    rotation="0 0 0">
                    <a-entity id="YoutubeButton" position="0.245 -0.6 0.005" mixin="youtubeframe"
                    class="raycastable menu-button" visible="true">
                    <a-entity id="youPoster" material="src: #youtubeposter" mixin="youtubeimage"></a-entity>
                </a-entity>
                </a-entity>
            </a-entity>


    </a-scene>
    <script>
        var scene = document.getElementById('scenemodel');

        scene.addEventListener('object3dset', () => {

            const mesh = scene.getObject3D('mesh');
            mesh.children[0].material = new THREE.MeshBasicMaterial({ map: mesh.children[0].material.map });
        });

    </script>
</body>

</html>